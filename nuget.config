<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <!-- Default NuGet.org source -->
    <add key="nuget.org" value="https://api.nuget.org/v3/index.json" protocolVersion="3" />
    
    <!-- Microsoft packages (explicit for .NET and Azure) -->
    <add key="dotnet-core" value="https://dotnetfeed.blob.core.windows.net/dotnet-core/index.json" />
    
    <!-- Uncomment if using Azure DevOps artifacts feed -->
    <!-- 
    <add key="AcmeInternalFeed" 
         value="https://pkgs.dev.azure.com/acme-corp/platform/_packaging/internal/nuget/v3/index.json" />
    -->
    
    <!-- Uncomment if using GitHub Package Registry -->
    <!--
    <add key="github" 
         value="https://nuget.pkg.github.com/acme-corp/index.json" />
    -->
  </packageSources>

  <packageSourceCredentials>
    <!-- Credentials for Azure DevOps (use Personal Access Token) -->
    <!-- 
    <AcmeInternalFeed>
      <add key="Username" value="AzureDevOps" />
      <add key="ClearTextPassword" value="%AZURE_DEVOPS_PAT%" />
    </AcmeInternalFeed>
    -->
    
    <!-- Credentials for GitHub Package Registry -->
    <!--
    <github>
      <add key="Username" value="%GITHUB_USERNAME%" />
      <add key="ClearTextPassword" value="%GITHUB_TOKEN%" />
    </github>
    -->
  </packageSourceCredentials>

  <packageSourceMapping>
    <!-- Map Microsoft packages to official sources -->
    <packageSource key="nuget.org">
      <package pattern="Microsoft.*" />
      <package pattern="System.*" />
      <package pattern="Azure.*" />
      <package pattern="Swashbuckle.*" />
      <package pattern="Serilog.*" />
      <package pattern="MediatR*" />
      <package pattern="FluentValidation*" />
      <package pattern="Polly*" />
      <package pattern="MassTransit*" />
      <package pattern="Testcontainers*" />
      <package pattern="xunit*" />
      <package pattern="Moq*" />
      <package pattern="FluentAssertions*" />
      <package pattern="coverlet.*" />
      <package pattern="Stryker.*" />
      <package pattern="OpenTelemetry*" />
      <package pattern="Yarp.*" />
      <package pattern="Npgsql*" />
      <package pattern="StackExchange.Redis*" />
      <package pattern="RabbitMQ.*" />
      <package pattern="Newtonsoft.Json*" />
      <package pattern="AutoMapper*" />
      <package pattern="Bogus*" />
      <package pattern="StyleCop.*" />
      <package pattern="SonarAnalyzer.*" />
      <package pattern="*" />
    </packageSource>
    
    <!-- Map internal packages to internal feed -->
    <!--
    <packageSource key="AcmeInternalFeed">
      <package pattern="Acme.*" />
      <package pattern="BuildingBlocks.*" />
    </packageSource>
    -->
  </packageSourceMapping>

  <config>
    <!-- Global package management settings -->
    <add key="globalPackagesFolder" value="packages" />
    <add key="repositoryPath" value="packages" />
    
    <!-- Dependency resolution settings -->
    <add key="dependencyVersion" value="Highest" />
    <add key="defaultPushSource" value="nuget.org" />
    
    <!-- Security settings -->
    <add key="signatureValidationMode" value="disabled" />
    <add key="trustedSigners" value="microsoft;nuget" />
    
    <!-- Temporary: Allow unsigned packages for development -->
    <add key="allowUntrustedPackages" value="true" />
    <add key="allowInsecureConnections" value="true" />
    
    <!-- Performance settings -->
    <add key="http_proxy" value="" />
    <add key="http_proxy.user" value="" />
    <add key="http_proxy.password" value="" />
    
    <!-- Package restore settings -->
    <add key="automatic-package-restore" value="true" />
    
    <!-- Disable package analysis for faster builds in CI -->
    <add key="SkipNuGetSecurityAudit" value="true" />
  </config>

  <trustedSigners>
    <!-- Trust Microsoft packages -->
    <author name="Microsoft">
      <certificate fingerprint="3F9001EA83C560D712C24CF213C3D312CB3BFF51EE89435D3430BD06B5D0EECE" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="false" />
      <certificate fingerprint="AA12DA22A49BCE7D5C1AE64CC1F3D892F150DA76140F210ABD2CBFFCA2C18A27" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="false" />
      <certificate fingerprint="566A31882BE208BE4422F7CFD66ED09F5D4524A5994F50CCC8B05EC0528C1353" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="true" />
    </author>
    
    <!-- Trust .NET Foundation packages -->
    <author name=".NET Foundation">
      <certificate fingerprint="E3C8C638B2DFB5AC5C5C93501638EF257C9D58E5E30F5781B5C90B65D5E7E7E5" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="true" />
      <certificate fingerprint="566A31882BE208BE4422F7CFD66ED09F5D4524A5994F50CCC8B05EC0528C1353" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="true" />
    </author>
    
    <!-- Trust NuGet.org repository -->
    <repository name="nuget.org" serviceIndex="https://api.nuget.org/v3/index.json">
      <certificate fingerprint="0E5F38F57DC1BCC806D8494F4F90FBCEDD988B46760709CBEEC6F4219AA6157D" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="false" />
      <certificate fingerprint="5A2901D6ADA3D18260B9C6DFE2133C95D74B9EEF6AE0E5DC334C8454D1477DF4" 
                   hashAlgorithm="SHA256" 
                   allowUntrustedRoot="false" />
      <certificate fingerprint="1F4B311D9ACC115C85DADDE8DEC355700FC793EE476A66B0DA3FC565A12AA4E8"
                   hashAlgorithm="SHA256"
                   allowUntrustedRoot="true" />
      <certificate fingerprint="1F4B311D9ACC115C8DC8018B5A49E00FCE6DA8E2855F9F014CA6F34570BC482D"
                   hashAlgorithm="SHA256"
                   allowUntrustedRoot="true" />
      <certificate fingerprint="B9752340121AB41446EEAB7484B7A8F176B54F3357CD601A4BE3DC7B1D08D11D"
                   hashAlgorithm="SHA256"
                   allowUntrustedRoot="true" />
    </repository>
  </trustedSigners>

  <packageRestore>
    <!-- Enable package restore for the solution -->
    <add key="enabled" value="True" />
    <add key="automatic" value="True" />
  </packageRestore>

  <bindingRedirects>
    <!-- Automatically generate binding redirects -->
    <add key="skip" value="False" />
  </bindingRedirects>

  <packageManagement>
    <!-- Package format settings -->
    <add key="format" value="1" />
    <add key="disabled" value="False" />
  </packageManagement>

  <!--
  Environment-specific settings:
  
  For Development:
  - Use local package cache for faster builds
  - Enable package source mapping for security
  - Use highest dependency version for latest features
  
  For CI/CD:
  - Use locked dependencies (packages.lock.json)
  - Enable package signature validation
  - Skip security audit for faster builds if needed
  
  For Production:
  - Use only trusted package sources  
  - Enable strict signature validation
  - Use deterministic package versions
  -->

</configuration>